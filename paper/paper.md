---
title: 'Oetqf: A Julia package for quasi-dynamic earthquake cycle simulation'
tags:
  - Julia
  - geophysics
  - earthquake dynamics
authors:
  - name: Pengcheng Shi
    orcid: 0000-0003-3558-458X
    affiliation: 1
  - name: Meng (Matt) Wei
    orcid: 0000-0002-7405-3389
    affiliation: 1
affiliations:
 - name: Graduate School of Oceanography, University of Rhode Island, Narragansett, RI, US
   index: 1
date: 06/01/2025
bibliography: paper.bib
---

# Summary

Oetqf is a Julia package designed to simulate quasi-dynamic earthquake cycles based on the rate- and state-dependent friction framework using the boundary element method (BEM). Simulating earthquake cycles is critical for advancing our understanding of earthquake dynamics and improving seismic hazard assessments.

This package enables researchers to replicate geophysical scenarios, such as a planar fault overlaying a viscoelastic mantle, and to compare synthetic earthquake sequences with both modern and historical observations. By varying material properties and exploring different physical mechanisms, users can investigate the underlying spatiotemporal patterns governing repeated seismic events.

Oetqf offers a user-friendly interface to facilitate efficient model construction and experimentation. Its modular design allows for the reuse and extension of core physical equations, enabling researchers to assemble customized models with ease. Additionally, the package integrates seamlessly with the broader Julia ecosystem, leveraging its extensive libraries for data analysis, differential equation solvers, mesh generation, and more.

With this package, we believe that it will greatly accelerate research progress in understanding earthquake physics and contribute to the broader effort of seismic hazards mitigation.

# Statement of need

Earthquakes pose a significant threat to societies and economies worldwide. Improving seismic hazard assessments requires a deeper understanding of the underlying physics of those damaging earthquakes. A fundamental challenge is the long recurrence interval of major seismic events. While modern instrumentation provides high-resolution data, it spans only a limited time period, and geological records of prehistoric earthquakes suffer from substantial uncertainties. Here, numerical simulation emerges as a powerful tool for advancing our understanding. By incorporating new physical mechanisms and validating models against real-world observations, simulations offer a complementary approach to empirical studies. The development of efficient, extensible, and user-friendly open-source simulation software is therefore essential to accelerating research progress in this field.

Several simulation codes have been developed within the research community [@erickson2020community; @erickson2023incorporating; @jiang2022community; @lambert2024community]. This package contributes a unique, open-source Julia implementation that couples 2D plane faults with 3D viscoelastic mantle relaxation. It is a capability essential for more realistic modeling. The interplay between mantle flow and earthquake cycles is well recognized [@allison2018earthquake; @barbot2018asthenosphere; @barbot2020frictional; @kato2002seismic; @lambert2016contribution; @shi2020structural; @smith2004three], yet few tools support their dynamic interaction. Our package, incorporating the theorectical Green's function for 3D anelastic deformation derived by @barbot2017displacement, addresses this gap and it has been successfully applied to model earthquake cycle on oceanic transform faults and to explain the synchronization behavior [@wei2021synchronization; @shi2022contribution]. To facilitate reproducibility, we provide a simplified tutorial in the code repository that replicates the published results.

Additionally, this package resolves numerical instability issues first observed in @shi2022contribution by computing Green’s functions via volumetric averaging rather than the commonly used collocation method in the boundary element method. This package enhances numerical stability and facilitates investigation into the role of 3D viscoelastic flow — an aspect has received less attention in the past due to computational complexity.

# Features

Written in Julia, this package leverages the language’s powerful ecosystem for scientific computing. For example, the simulation is formulated as a system of ordinary differential equations (ODEs) that is numerically optimized, and is able to leverage the highly performant algorithms in [@DifferentialEquations.jl-2017]. Intermediate solutions can be saved to HDF5 through an integrated callback mechanism for detailed time-series analysis.

The package provides convenient APIs for problem domain construction. It supports a single plane fault with a customizable transfinite mesh and a 3D mantle volume using a hexahedral mesh generated by Gmsh [@geuzaine2008gmsh]. To simplify mesh generation, we developed a companion sub-package, GmshTools [@gmshtools], which automates model construction and offers user-friendly macros. Moreover, this package integrates with VTK [@polanco_2023_7804590] so users can leverage ParaView to visualize the data.

Once the domain is built, users can compute stress Green’s functions using another sub-package, GeoGreensFunctions [@geogreensfunctions], which includes a collection of commonly used solutions for seismic and geodetic applications [@okada1992internal; @segall2010earthquake; @nikkhoo2015triangular; @nikkhoo2016compound; @barbot2017displacement; @barbot2018deformation], translated into native Julia code with performance in mind.

The package supports a variety of physical laws governing fault evolution. For state evolution, it implements the aging law [@ruina1983slip], and for frictional behavior, it includes the regularized rate-and-state law [@rubin2005earthquake], with optional dilatancy strengthening [@liu2013numerical]. Julia’s multiple dispatch paradigm enables users to easily incorporate new physical processes and construct customized ODE systems by reusing and extending existing components. This design ensures the package remains flexible and adaptable to evolving research needs.

# Acknowledgements

Pengcheng Shi and Meng Wei are supported by the United States National Science Foundation (OCE-1654416).

# References

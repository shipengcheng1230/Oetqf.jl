<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>A 2D transform fault overlaying a 3D mantle ¬∑ Oetqf</title><meta name="title" content="A 2D transform fault overlaying a 3D mantle ¬∑ Oetqf"/><meta property="og:title" content="A 2D transform fault overlaying a 3D mantle ¬∑ Oetqf"/><meta property="twitter:title" content="A 2D transform fault overlaying a 3D mantle ¬∑ Oetqf"/><meta name="description" content="Documentation for Oetqf."/><meta property="og:description" content="Documentation for Oetqf."/><meta property="twitter:description" content="Documentation for Oetqf."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Oetqf</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>A 2D transform fault overlaying a 3D mantle</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Generate-the-meshes"><span>Generate the meshes</span></a></li><li class="toplevel"><a class="tocitem" href="#Compute-the-stress-Green&#39;s-functions"><span>Compute the stress Green&#39;s functions</span></a></li><li class="toplevel"><a class="tocitem" href="#Set-up-parameters"><span>Set up parameters</span></a></li><li class="toplevel"><a class="tocitem" href="#Set-up-initial-conditions"><span>Set up initial conditions</span></a></li><li class="toplevel"><a class="tocitem" href="#Assemble-the-problem"><span>Assemble the problem</span></a></li><li class="toplevel"><a class="tocitem" href="#Analyze-the-results"><span>Analyze the results</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../parameters/">Parameters</a></li><li><a class="tocitem" href="../../testing/">Testing</a></li><li><a class="tocitem" href="../../APIs/">APIs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>A 2D transform fault overlaying a 3D mantle</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>A 2D transform fault overlaying a 3D mantle</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/shipengcheng1230/Oetqf.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/shipengcheng1230/Oetqf.jl/blob/master/examples/otf-with-mantle.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><div class="admonition is-info" id="Note-f86eb58cf5fffd3"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-f86eb58cf5fffd3" title="Permalink"></a></header><div class="admonition-body"><p>This example corresponds to the simulations in Shi, P., Wei, M., &amp; Barbot, S. (2022), JGR - Solid Earth - 10.1029/2022jb024069. The mesh size is reduced to improve CI/CD speed and avoid timeouts.</p></div></div><h1 id="Problem-statement"><a class="docs-heading-anchor" href="#Problem-statement">Problem statement</a><a id="Problem-statement-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-statement" title="Permalink"></a></h1><p>We would like to investigate the stress interaction between a 2D plane transform fault and a 3D mantle and how it affects the seismic pattern.</p><pre><code class="language-julia hljs">using Oetqf, SpecialFunctions, Optim</code></pre><h1 id="Generate-the-meshes"><a class="docs-heading-anchor" href="#Generate-the-meshes">Generate the meshes</a><a id="Generate-the-meshes-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-the-meshes" title="Permalink"></a></h1><p>Generate the mesh for the transform fault, which is suitable for using the Okada (1992) equation. The fault is 80 km long, 8 km deep, with grid sizes of 10 km and 2 km respectively, and a dip angle of 90 degrees (vertical).</p><pre><code class="language-julia hljs">mf = gen_mesh(Val(:RectOkada), 80e3, 8e3, 10e3, 2e3, 90.0);</code></pre><p>The mesh <code>mf</code> is a <code>RectOkadaMesh</code>, which contains the fault geometry, centroid coordinates, and other properties.</p><p>Use Gmsh to generate the mantle mesh, which is suitable for using the Barbot et al. (2017) equation. The volume is 80 km long, 5 km wide, and 14 km deep, with a grid size of 4 cells along the <strong>x</strong> direction, 3 cells along the <strong>y</strong> direction, and 3 cells along the <strong>z</strong> direction. There is no refinement in the <strong>x</strong> or <strong>y</strong> direction, while cell sizes are 1.5 times progressively larger along the <strong>z</strong> axis.</p><pre><code class="language-julia hljs">gen_gmsh_mesh(Val(:BEMHex8Mesh), -40e3, -2.5e3, -8e3, 80e3, 5e3, -22e3, 4, 3, 3;
    output = joinpath(@__DIR__, &quot;mantle.vtk&quot;),
    rfzh = cumprod(ones(3) * 1.5), rfy = 1.0, rfyType = &quot;Bump&quot;
)
ma = gen_mesh(Val(:BEMHex8Mesh), joinpath(@__DIR__, &quot;mantle.vtk&quot;));</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Info    : Meshing 1D...
Info    : [  0%] Meshing curve 1 (Line)
Info    : [ 10%] Meshing curve 2 (Line)
Info    : [ 20%] Meshing curve 3 (Line)
Info    : [ 30%] Meshing curve 4 (Line)
Info    : [ 40%] Meshing curve 6 (Extruded)
Info    : [ 50%] Meshing curve 7 (Extruded)
Info    : [ 50%] Meshing curve 8 (Extruded)
Info    : [ 60%] Meshing curve 9 (Extruded)
Info    : [ 70%] Meshing curve 11 (Extruded)
Info    : [ 80%] Meshing curve 12 (Extruded)
Info    : [ 90%] Meshing curve 16 (Extruded)
Info    : [100%] Meshing curve 20 (Extruded)
Info    : Done meshing 1D (Wall 0.00020328s, CPU 0.000198s)
Info    : Meshing 2D...
Info    : [  0%] Meshing surface 1 (Transfinite)
Info    : [ 20%] Meshing surface 13 (Extruded)
Info    : [ 40%] Meshing surface 17 (Extruded)
Info    : [ 50%] Meshing surface 21 (Extruded)
Info    : [ 70%] Meshing surface 25 (Extruded)
Info    : [ 90%] Meshing surface 26 (Extruded)
Info    : Done meshing 2D (Wall 0.000263143s, CPU 0.000255s)
Info    : Meshing 3D...
Info    : Meshing volume 1 (Extruded)
Info    : Done meshing 3D (Wall 0.000125084s, CPU 0.000121s)
Info    : Optimizing mesh...
Info    : Done optimizing mesh (Wall 2.474e-06s, CPU 3e-06s)
Info    : 80 nodes 150 elements
Info    : Writing &#39;/home/runner/work/Oetqf.jl/Oetqf.jl/docs/build/generated/mantle.vtk&#39;...
Info    : Done writing &#39;/home/runner/work/Oetqf.jl/Oetqf.jl/docs/build/generated/mantle.vtk&#39;
Info    : Reading &#39;/home/runner/work/Oetqf.jl/Oetqf.jl/docs/build/generated/mantle.vtk&#39;...
Info    : Reading 80 points
Info    : Reading 150 cells
Info    : Done reading &#39;/home/runner/work/Oetqf.jl/Oetqf.jl/docs/build/generated/mantle.vtk&#39;</code></pre><p>The mesh <code>ma</code> is a <code>BEMHex8Mesh</code>, which contains the mantle geometry, centroid coordinates, and other properties.</p><h1 id="Compute-the-stress-Green&#39;s-functions"><a class="docs-heading-anchor" href="#Compute-the-stress-Green&#39;s-functions">Compute the stress Green&#39;s functions</a><a id="Compute-the-stress-Green&#39;s-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Compute-the-stress-Green&#39;s-functions" title="Permalink"></a></h1><p>Assume the shear modulus and the Lam√© parameter are both 3e10 Pa.</p><pre><code class="language-julia hljs">Œª = Œº = 3e10;</code></pre><p>Initialize the path to save the stress Green&#39;s functions.</p><pre><code class="language-julia hljs">gffile = joinpath(@__DIR__, &quot;gf.h5&quot;)
isfile(gffile) &amp;&amp; rm(gffile);</code></pre><p>Compute the stress Green&#39;s functions within the fault. We add a buffer zone of 1 times the fault length on both sides of the fault to avoid edge effects.</p><pre><code class="language-julia hljs">@time gf‚ÇÅ‚ÇÅ = stress_greens_function(mf, Œª, Œº; buffer_ratio = 1)
h5write(gffile, &quot;gf‚ÇÅ‚ÇÅ&quot;, gf‚ÇÅ‚ÇÅ); # fault -&gt; fault</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">  1.120374 seconds (2.35 M allocations: 111.543 MiB, 1.51% gc time, 99.79% compilation time)</code></pre><p>Compute the stress Green&#39;s functions from the fault to the mantle.</p><pre><code class="language-julia hljs">@time gf‚ÇÅ‚ÇÇ = stress_greens_function(mf, ma, Œª, Œº; buffer_ratio = 1, qtype = &quot;Gauss1&quot;)
h5write(gffile, &quot;gf‚ÇÅ‚ÇÇ&quot;, gf‚ÇÅ‚ÇÇ); # fault -&gt; mantle</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">  0.450150 seconds (262.03 k allocations: 12.801 MiB, 3.20% gc time, 87.90% compilation time)</code></pre><p>Compute the stress Green&#39;s functions from the mantle to the fault and within the mantle.</p><pre><code class="language-julia hljs">@time gf‚ÇÇ‚ÇÅ = stress_greens_function(ma, mf, Œª, Œº)
h5write(gffile, &quot;gf‚ÇÇ‚ÇÅ&quot;, gf‚ÇÇ‚ÇÅ); # mantle -&gt; fault</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">  4.635343 seconds (10.76 M allocations: 459.575 MiB, 1.31% gc time, 90.92% compilation time)</code></pre><p>Compute the stress Green&#39;s functions within the mantle, using Gauss1 quadrature.</p><pre><code class="language-julia hljs">@time gf‚ÇÇ‚ÇÇ = stress_greens_function(ma, Œª, Œº; qtype = &quot;Gauss1&quot;)
h5write(gffile, &quot;gf‚ÇÇ‚ÇÇ&quot;, gf‚ÇÇ‚ÇÇ); # mantle -&gt; mantle</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Maximum real part of eigval is: 1111120100.9504
  3.919068 seconds (1.20 M allocations: 63.217 MiB, 0.23% gc time, 26.71% compilation time)</code></pre><div class="admonition is-success" id="Tip-ed35e49a19132418"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-ed35e49a19132418" title="Permalink"></a></header><div class="admonition-body"><p>The <code>buffer_ratio</code> denotes the fraction of the original fault length on the two sides of the fault in which no dislocation occurs. It serves as a buffer zone to imitate the ridge section on the edges of an oceanic transform fault (personal communication with Yajing Liu). Basically, it affects how the stiffness tensor is periodically summed.</p></div></div><div class="admonition is-success" id="Tip-6236f2211b59e597"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-6236f2211b59e597" title="Permalink"></a></header><div class="admonition-body"><p>Notice that, in Gmsh before v4.9, the quadrature type &quot;Gauss2&quot; does not stand for the product rule; instead, it is an optimized cubature rule (see <a href="https://gitlab.onelab.info/gmsh/gmsh/-/issues/1351">this issue</a>). For more cubature rules, see <a href="https://github.com/nschloe/quadpy">quadpy</a>.</p></div></div><div class="admonition is-success" id="Tip-455d0e48abd47ff5"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-455d0e48abd47ff5" title="Permalink"></a></header><div class="admonition-body"><p>It is recommended to use at least <code>Gauss2</code> quadrature for the mantle mesh to ensure the maximum real part of the eigenvalues of the stiffness tensor is small. The volumetric mean has drastically reduced it to avoid numerical instability. See the appendix of the <a href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2022JB024069">Shi et al., 2022</a> for more details.</p></div></div><h1 id="Set-up-parameters"><a class="docs-heading-anchor" href="#Set-up-parameters">Set up parameters</a><a id="Set-up-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Set-up-parameters" title="Permalink"></a></h1><p>Set up the rate-and-state friction parameters on the fault. We include two velocity-weakening patches on the fault: one on the left side between -25 km and -5 km, and the other on the right side between 5 km and 25 km, and the depth between -6 km and -1 km.</p><pre><code class="language-julia hljs">cs = 3044.14 # m/s
vpl = 140e-3 / 365 / 86400 # 140 mm/yr
v0 = 1e-6
f0 = 0.6
Œº = 3e10
Œ∑ = Œº / 2cs # radiation damping
ŒΩ = Œª / 2(Œª + Œº)
avw = 0.015
abvw = 0.0047
Dc = 8e-3
œÉmax = 5e7
a = ones(mf.nx, mf.nŒæ) .* avw
b = ones(mf.nx, mf.nŒæ) .* (avw - abvw)
L = ones(mf.nx, mf.nŒæ) .* Dc
œÉ = [min(œÉmax, 1.5e6 + 18.0e3 * z) for z in -mf.z] # Pa
œÉ = repeat(œÉ, 1, mf.nx)&#39; |&gt; Matrix # Pa
left_patch = @. -25.e3 ‚â§ mf.x ‚â§ -5.e3
right_patch = @. 5.e3 ‚â§ mf.x ‚â§ 25.e3
vert_patch = @. -6.e3 ‚â§ mf.z ‚â§ -1e3
b[xor.(left_patch, right_patch), vert_patch] .= avw + abvw # assign velocity weakening
pf = RateStateQuasiDynamicProperty(a, b, L, œÉ, Œ∑, vpl, f0, v0)
save_property(joinpath(@__DIR__, &quot;para-fault.bson&quot;), pf);</code></pre><p>Set up rheology parameters in the mantle assuming power-law viscosity with lab-derived results.</p><pre><code class="language-julia hljs">A_wet_dis = 3e1
Q_wet_dis = 480e3
V_wet_dis = 11e-6
m_wet_dis = 0
r_wet_dis = 1.2
n_wet_dis = 3.5
grain_size = 10000.0 # Œºm
COH = 1000 # ppm / HSi
ùôç = 8.314 # gas constant
crust_depth = 7e3
Œ∫ = 8e-7
ùöÉ(z) = 1673 * erf(z / sqrt(4Œ∫ * 1e6 * 365 * 86400)) # 1 Myr OTF
ùôø(z) = 2800 * 9.8 * crust_depth + 3300 * 9.8 * (z - crust_depth)
prefactor_dis(z) = A_wet_dis / (1e6)^n_wet_dis * COH^r_wet_dis * grain_size^m_wet_dis * exp(-(Q_wet_dis + ùôø(z) * V_wet_dis) / ùôç / ùöÉ(z))
rel_dœµ = [0.0, -1e-12, 0.0, 0.0, 0.0, 0.0]
amplifier = 1e0
Œ≥_dis = prefactor_dis.(-ma.cz) .* amplifier
pa = PowerLawViscosityProperty(Œ≥_dis, ones(length(ma.cz)) * (n_wet_dis - 1), rel_dœµ) # note to save `n-1` instead of `n`, where `n` refers to the stress power
save_property(joinpath(@__DIR__, &quot;para-mantle&quot; * &quot;.bson&quot;), pa);</code></pre><div class="admonition is-warning" id="Warning-527e600d9f285cdb"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-527e600d9f285cdb" title="Permalink"></a></header><div class="admonition-body"><p>Make sure your units are consistent across the whole variable space. Also, note that we save <code>n-1</code> instead of <code>n</code>, where <code>n</code> refers to the stress power.</p></div></div><div class="admonition is-success" id="Tip-ceefa655bdc1e43f"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-ceefa655bdc1e43f" title="Permalink"></a></header><div class="admonition-body"><p>To load existing properties, use <code>load_property(YOUR_FILE, :RateStateQuasiDynamicProperty)</code> or <code>load_property(YOUR_FILE, :PowerLawViscosityProperty)</code> accordingly.</p></div></div><h1 id="Set-up-initial-conditions"><a class="docs-heading-anchor" href="#Set-up-initial-conditions">Set up initial conditions</a><a id="Set-up-initial-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Set-up-initial-conditions" title="Permalink"></a></h1><p>We set up a uniform initial velocity field equal to the plate rate on the fault, with slight perturbations in the state variable of the left and right halves of the fault.</p><pre><code class="language-julia hljs">vinit = pf.vpl .* ones(size(pf.a))
Œ∏init = pf.L ./ vinit
Œ∏init[1: size(Œ∏init, 1) &gt;&gt; 1, :] ./= 1.1
Œ∏init[size(Œ∏init, 1) &gt;&gt; 1 + 1: end, :] ./= 2.5
Œ¥init = zeros(size(pf.a));</code></pre><p>We set up initial conditions in the mantle where the initial stress matches the background strain rate through a simple 1D optimization.</p><pre><code class="language-julia hljs">œµinit = zeros(length(pa.Œ≥), 6)
P = map(z -&gt; 2800 * 9.8 * crust_depth + 3300 * 9.8 * (z - crust_depth), -ma.cz) # change the depth of crust
œÉinit = repeat(P, 1, 6)
œÉinit[:,3] .= 0.0 # xz
œÉinit[:,5] .= 0.0 # yz
target(i) = x -&gt; (pa.Œ≥[i] * (sqrt(2) * x) ^ (pa.n[i]) * x - abs(pa.dœµ‚ÇÄ[2])) ^ 2
œÉxyinit = -map(i -&gt; Optim.minimizer(optimize(target(i), 1e1, 1e14)), 1: length(pa.Œ≥))
reldœµ = map(i -&gt; pa.Œ≥[i] * (sqrt(2) * abs(œÉxyinit[i])) ^ (pa.n[i]) * œÉxyinit[i], 1: length(pa.Œ≥))
@assert all(isapprox.(reldœµ, pa.dœµ‚ÇÄ[2]; rtol=1e-3))
œÉinit[:,2] .= œÉxyinit;</code></pre><h1 id="Assemble-the-problem"><a class="docs-heading-anchor" href="#Assemble-the-problem">Assemble the problem</a><a id="Assemble-the-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Assemble-the-problem" title="Permalink"></a></h1><p>Using the Green&#39;s functions, the properties, and the initial conditions, we assemble the problem. Notice the order of the variables here must be velocity, state variable, strain, stress, and slip.</p><pre><code class="language-julia hljs">uinit = ArrayPartition(vinit, Œ∏init, œµinit, œÉinit, Œ¥init)
prob = assemble(gf‚ÇÅ‚ÇÅ, gf‚ÇÅ‚ÇÇ, gf‚ÇÇ‚ÇÅ, gf‚ÇÇ‚ÇÇ, pf, pa, uinit, (0.0, 0.1 * 365 * 86400));</code></pre><p>We set up the saving scheme and solve the equation. Here, we will save (in the order of) velocity, state variable, strain rate, strain, stress, and slip, every 100 steps. All the variables are named exactly the same as in the equations.</p><pre><code class="language-julia hljs">handler(u::ArrayPartition, t, integrator) = (u.x[1], u.x[2], integrator(integrator.t, Val{1}).x[3], u.x[3], u.x[4], u.x[5])
output = joinpath(@__DIR__, &quot;output.h5&quot;)
@time sol = wsolve(prob, VCABM5(), output, 100, handler, [&quot;v&quot;, &quot;Œ∏&quot;, &quot;dœµ&quot;, &quot;œµ&quot;, &quot;œÉ&quot;, &quot;Œ¥&quot;], &quot;t&quot;;
    reltol=1e-6, abstol=1e-8, dtmax=0.2*365*86400, dt=1e-8, maxiters=1e9, stride=100, force=true
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: 1st order linear
t: 2-element Vector{Float64}:
 0.0
 3.1536e6
u: 2-element Vector{ArrayPartition{Float64, NTuple{5, Matrix{Float64}}}}:
 ([4.439370877727043e-9 4.439370877727043e-9 4.439370877727043e-9 4.439370877727043e-9; 4.439370877727043e-9 4.439370877727043e-9 4.439370877727043e-9 4.439370877727043e-9; ‚Ä¶ ; 4.439370877727043e-9 4.439370877727043e-9 4.439370877727043e-9 4.439370877727043e-9; 4.439370877727043e-9 4.439370877727043e-9 4.439370877727043e-9 4.439370877727043e-9], [1.6382337662337658e6 1.6382337662337658e6 1.6382337662337658e6 1.6382337662337658e6; 1.6382337662337658e6 1.6382337662337658e6 1.6382337662337658e6 1.6382337662337658e6; ‚Ä¶ ; 720822.857142857 720822.857142857 720822.857142857 720822.857142857; 720822.857142857 720822.857142857 720822.857142857 720822.857142857], [0.0 0.0 ‚Ä¶ 0.0 0.0; 0.0 0.0 ‚Ä¶ 0.0 0.0; ‚Ä¶ ; 0.0 0.0 ‚Ä¶ 0.0 0.0; 0.0 0.0 ‚Ä¶ 0.0 0.0], [2.993126315789474e8 -1.159793132258934e6 ‚Ä¶ 0.0 2.993126315789474e8; 4.865442105263158e8 -279723.0841659712 ‚Ä¶ 0.0 4.865442105263158e8; ‚Ä¶ ; 4.865442105263158e8 -279723.0841659712 ‚Ä¶ 0.0 4.865442105263158e8; 7.673915789473685e8 -235923.5595516861 ‚Ä¶ 0.0 7.673915789473685e8], [0.0 0.0 0.0 0.0; 0.0 0.0 0.0 0.0; ‚Ä¶ ; 0.0 0.0 0.0 0.0; 0.0 0.0 0.0 0.0])
 ([4.076715958989289e-9 4.072616164245145e-9 4.075442712126598e-9 4.088964986453331e-9; 3.4430994939670944e-9 3.417383507269353e-9 3.4394142408770543e-9 4.062644179678046e-9; ‚Ä¶ ; 7.586803484447171e-10 7.350000896538302e-10 7.495634381963362e-10 2.0502107855143374e-9; 2.0738117461621434e-9 2.038088880757506e-9 2.047039752307764e-9 2.096094491124679e-9], [1.8590418302568565e6 1.8598256460833005e6 1.8593496132564675e6 1.8570189571762218e6; 2.0017790265015583e6 2.0064139281027382e6 2.002447943468171e6 1.8612812874577832e6; ‚Ä¶ ; 2.8747044541461663e6 2.885326781900475e6 2.8786601284604673e6 2.2772683705092487e6; 2.270762754954703e6 2.279965869236065e6 2.2775966294517145e6 2.2647807208464365e6], [-1.9490353719142703e-10 -3.150225479742601e-6 ‚Ä¶ 1.117009381251456e-10 -5.7605857040498805e-12; -3.143400770248431e-10 -3.147648023609172e-6 ‚Ä¶ 4.658202337483857e-10 -4.579661948262328e-11; ‚Ä¶ ; -5.615414367667751e-10 -3.1305062949498476e-6 ‚Ä¶ -9.98692990183044e-10 -6.379063666159174e-10; -1.2895020205790048e-10 -3.1447258792037835e-6 ‚Ä¶ -6.507466105621481e-10 -2.713827511764087e-10], [2.993123106670286e8 -1.1588113187909983e6 ‚Ä¶ 109.26822681446149 2.993125101945185e8; 4.865440819229592e8 -279332.7091081294 ‚Ä¶ 107.15415541021898 4.865441499927149e8; ‚Ä¶ ; 4.8654392870839775e8 -278353.03260683204 ‚Ä¶ -211.77388305242889 4.8654394576009667e8; 7.673915013824518e8 -235463.28389308814 ‚Ä¶ -117.59525704444525 7.673914887318344e8], [0.013352977245283152 0.01334786179521655 0.01335086397226022 0.013365680395724845; 0.012402031284994014 0.012375690899781236 0.012398238171474936 0.013339120423498973; ‚Ä¶ ; 0.005481590194932253 0.00543582127551878 0.005464691937056686 0.008821136502916271; 0.008856835815734015 0.008807659239440364 0.008820414423926334 0.008889500625309089])</code></pre><div class="admonition is-success" id="Tip-68aa5ed92297d00b"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-68aa5ed92297d00b" title="Permalink"></a></header><div class="admonition-body"><p>See <a href="https://github.com/SciML/OrdinaryDiffEq.jl/issues/785">this issue</a> to learn more about retrieving derivatives in the solution.</p></div></div><div class="admonition is-success" id="Tip-4a4c90eafeed4ff1"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-4a4c90eafeed4ff1" title="Permalink"></a></header><div class="admonition-body"><p>We often find that multi-step solvers like <code>VCABM5</code> are more efficient than single-step solvers like <code>Tsit5</code> for this kind of problem.</p></div></div><h1 id="Analyze-the-results"><a class="docs-heading-anchor" href="#Analyze-the-results">Analyze the results</a><a id="Analyze-the-results-1"></a><a class="docs-heading-anchor-permalink" href="#Analyze-the-results" title="Permalink"></a></h1><p>The solution is saved in the <code>output.h5</code> file, which contains the time series of velocity, state variable, strain rate, strain, stress, and slip. We can load the solution and analyze the results, for example, extracting the earthquake catalog from the velocity time series, visualizing the fault rupture, mantle strain flow, etc. Readers are encouraged to explore the figures in the <a href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2022JB024069">Shi et al., 2022</a> for more insights.</p><div class="admonition is-success" id="Tip-8cdb6fea1ff9a3e7"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-8cdb6fea1ff9a3e7" title="Permalink"></a></header><div class="admonition-body"><p>To generate the PVD files for visualization in Paraview, we can use the following functions. The output PVD file can be opened in Paraview to visualize the animation of the fault and mantle evolution. It includes the velocity and state variable on the fault and strain rate in the mantle, for all the time steps.</p><pre><code class="language-julia hljs">gen_pvd(mf, joinpath(@__DIR__, &quot;mantle.vtk&quot;), output, &quot;t&quot;, [&quot;v&quot;, &quot;Œ∏&quot;], [&quot;dœµ&quot;], 1: length(sol.t), joinpath(@__DIR__, &quot;sol.pvd&quot;))</code></pre></div></div><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">¬´ Home</a><a class="docs-footer-nextpage" href="../../parameters/">Parameters ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 8 October 2025 01:41">Wednesday 8 October 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
